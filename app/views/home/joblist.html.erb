<div class="container-fluid">
  <div class="border border-dark mt-3 pb-3">
    <h1 class="h3 bg-secondary text-white p-2 mb-4">求人を検索</h1>
    <%= form_with url: "#", method: :post do |form| %>
      <div class="row">
        <!-- First Table (職種 & 給与) -->
        <div class="col-md-6">
          <table class="w-100">
            <tbody>
              <tr>
                <td class="text-end align-middle pe-2 pb-3">
                  <%= form.label :category_id, "職種", class: "form-label mb-0" %>
                </td>
                <td class="pb-3">
                  <%= form.select :category_id, 
                        options_for_select([["選択してください", "", { disabled: true, selected: true }]] + @categories), 
                        {}, 
                        { class: "form-select", required: true } %>
                </td>
              </tr>
              <tr>
                <td class="text-end align-middle pe-2 pb-3">給与</td>
                <td class="d-flex pb-3">
                  <%= form.select :min_salary, 
                        options_for_select([["最低給与", "", { disabled: true, selected: true }]] + [[200_000, 200_000], [300_000, 300_000], [400_000, 400_000]]), 
                        {}, 
                        { class: "form-select me-2" } %>
                  <span class="align-self-center">〜</span>
                  <%= form.select :max_salary, 
                        options_for_select([["最高給与", "", { disabled: true, selected: true }]] + [[500_000, 500_000], [600_000, 600_000], [700_000, 700_000]]), 
                        {}, 
                        { class: "form-select ms-2" } %>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Second Table (スキル & 通勤地) -->
        <div class="col-md-6 pe-5">
          <table class="w-100">
            <tbody>
              <tr>
                <td class="text-end align-middle pe-2 pb-3">
                  <%= form.label :skill_id, "スキル", class: "form-label mb-0" %>
                </td>
                <td class="pb-3">
                  <%= form.select :skill_id, 
                        options_for_select([["選択してください", "", { disabled: true, selected: true }]] + @skills), 
                        {}, 
                        { class: "form-select", multiple: true, id: "skill_select", size: 1 } %>
                </td>
              </tr>
              <tr>
                <td class="text-end align-middle pe-2 pb-3">
                  <%= form.label :location_id, "通勤地", class: "form-label mb-0" %>
                </td>
                <td class="pb-3">
                  <%= form.select :location_id, 
                        options_for_select([["選択してください", "", { disabled: true, selected: true }]] + @locations), 
                        {}, 
                        { class: "form-select", required: true } %>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="text-start ms-5 ps-2">
        <%= form.submit "検索", class: "btn btn-success" %>
      </div>
    <% end %>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const skillSelect = document.getElementById("skill_select");

  skillSelect.addEventListener("mousedown", function(event) {
    if (!this.classList.contains("expanded")) {
      event.preventDefault(); // Prevent default select behavior
      this.size = Math.min(this.options.length, 5); // Expand select (limit size to 5)
      this.classList.add("expanded"); // Add class to style it
    }
  });

  skillSelect.addEventListener("blur", function() {
    this.size = 1; // Collapse select when clicked away
    this.classList.remove("expanded"); // Remove class
  });
});
</script>
